import{u as N,c as w,a as p,j as e}from"./query-D1a_yXj4.js";import{c as b}from"./ui-ui_Xg26j.js";import{a as k,c as L,t as v}from"./index-DnrrN0sm.js";import{g as C}from"./client-5MNKdqIS.js";import{A}from"./Avatar-DGvJejrI.js";import"./Input-DANlLABD.js";import"./router-CqRdUfwj.js";function B(s){return C("/agents/status",s)}const u={all:["agents"],status:()=>[...u.all,"status"],details:()=>[...u.all,"detail"],detail:s=>[...u.details(),s]};function M(){return N({queryKey:u.status(),queryFn:async({signal:s})=>B(s),refetchInterval:3e4})}function _(){const s=w(),{state:t,connect:a,disconnect:r}=k(),i=t==="connected",l=p.useCallback(c=>{s.setQueryData(u.status(),()=>({agents:c.agents.map(o=>({id:o.id,name:o.name,status:o.status,last_active_at:o.last_active_at,seconds_since_heartbeat:o.seconds_since_heartbeat})),counts:c.counts}))},[s]);return L(l),{isConnected:i,connect:a,disconnect:r}}function f(...s){return v(b(s))}const I={active:{bg:"bg-green-50",text:"text-green-700",dot:"bg-green-400"},busy:{bg:"bg-yellow-50",text:"text-yellow-700",dot:"bg-yellow-400"},idle:{bg:"bg-gray-50",text:"text-gray-600",dot:"bg-gray-400"},offline:{bg:"bg-gray-100",text:"text-gray-500",dot:"bg-gray-300"}},W={active:"Active",busy:"Busy",idle:"Idle",offline:"Offline"};function z({status:s,size:t="md",className:a}){const r=I[s];return e.jsxs("span",{className:f("inline-flex items-center gap-1.5 rounded-full font-medium",r.bg,r.text,t==="sm"?"px-2 py-0.5 text-xs":"px-2.5 py-1 text-sm",a),children:[e.jsx("span",{className:f("rounded-full",r.dot,t==="sm"?"h-1.5 w-1.5":"h-2 w-2")}),W[s]]})}function S(s){return s<60?"Just now":s<3600?`${Math.floor(s/60)}m ago`:s<86400?`${Math.floor(s/3600)}h ago`:`${Math.floor(s/86400)}d ago`}function $({agent:s,onClick:t,isSelected:a=!1,className:r}){return e.jsxs("div",{className:f("rounded-lg border bg-white p-4 transition-all",t?"cursor-pointer hover:shadow-md":"",a?"border-blue-300 ring-2 ring-blue-100":"border-gray-200 hover:border-gray-300",r),onClick:t,role:t?"button":void 0,tabIndex:t?0:void 0,onKeyDown:t?i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),t())}:void 0,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{name:s.name,size:"md"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:S(s.seconds_since_heartbeat)})]})]}),e.jsx(z,{status:s.status,size:"sm"})]}),s.session_id!==void 0?e.jsxs("div",{className:"mt-3 rounded bg-gray-50 px-3 py-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Current session"}),e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["#",s.session_id]})]}):null]})}function D(){return e.jsx("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 animate-pulse rounded-full bg-gray-200"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 w-24 animate-pulse rounded bg-gray-200"}),e.jsx("div",{className:"h-3 w-16 animate-pulse rounded bg-gray-200"})]})]}),e.jsx("div",{className:"h-6 w-16 animate-pulse rounded-full bg-gray-200"})]})})}function d(...s){return v(b(s))}function E({className:s}){return e.jsx("svg",{className:d("h-5 w-5",s),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}function F({className:s}){return e.jsx("svg",{className:d("h-5 w-5",s),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}function T({className:s}){return e.jsx("svg",{className:d("h-5 w-5",s),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}function U({className:s}){return e.jsx("svg",{className:d("h-5 w-5",s),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"})})}function x({label:s,value:t,icon:a,iconBg:r,iconColor:i,onClick:l}){const c=l?"button":"div";return e.jsxs(c,{onClick:l,className:d("flex items-center gap-4 rounded-lg border border-gray-200 bg-white p-4",l?"cursor-pointer text-left hover:border-gray-300 hover:shadow-sm transition-all":"",l?"focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2":""),children:[e.jsx("div",{className:d("flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-lg",r,i),children:a}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:s}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t})]})]})}function q({counts:s,isLoading:t=!1,onStatClick:a,className:r}){if(t)return e.jsx("div",{className:d("grid grid-cols-2 gap-4 md:grid-cols-4",r),children:[1,2,3,4].map(l=>e.jsx("div",{className:"h-20 animate-pulse rounded-lg border border-gray-200 bg-gray-100"},l))});const i=(s?.active??0)+(s?.busy??0)+(s?.idle??0)+(s?.offline??0);return e.jsxs("div",{className:d("grid grid-cols-2 gap-4 md:grid-cols-4",r),children:[e.jsx(x,{label:"Total Agents",value:i,icon:e.jsx(E,{}),iconBg:"bg-gray-100",iconColor:"text-gray-600"}),e.jsx(x,{label:"Active",value:s?.active??0,icon:e.jsx(F,{}),iconBg:"bg-green-100",iconColor:"text-green-600",onClick:a?()=>a("active"):void 0}),e.jsx(x,{label:"Busy",value:s?.busy??0,icon:e.jsx(U,{}),iconBg:"bg-yellow-100",iconColor:"text-yellow-600",onClick:a?()=>a("busy"):void 0}),e.jsx(x,{label:"Idle",value:s?.idle??0,icon:e.jsx(T,{}),iconBg:"bg-gray-100",iconColor:"text-gray-500",onClick:a?()=>a("idle"):void 0})]})}function h(...s){return v(b(s))}const H=[{id:"all",label:"All"},{id:"active",label:"Active"},{id:"busy",label:"Busy"},{id:"idle",label:"Idle"},{id:"offline",label:"Offline"}];function K({message:s,onRetry:t}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"mb-4 rounded-full bg-red-100 p-3",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"mb-1 text-lg font-medium text-gray-900",children:"Failed to load agents"}),e.jsx("p",{className:"mb-4 text-sm text-gray-500",children:s}),t?e.jsx("button",{onClick:t,className:"rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Try Again"}):null]})}function Q({filter:s}){const t=s==="all"?"":` ${s}`;return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"mb-4 rounded-full bg-gray-100 p-3",children:e.jsx("svg",{className:"h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("h3",{className:"mb-1 text-lg font-medium text-gray-900",children:["No",t," agents"]}),e.jsx("p",{className:"text-sm text-gray-500",children:s==="all"?"No agents have been registered yet.":`No agents are currently ${s}.`})]})}function Y({onAgentClick:s,onRegisterClick:t,className:a}){const[r,i]=p.useState("all"),{data:l,isLoading:c,error:o,refetch:j}=M(),{isConnected:g}=_(),m=r==="all"?l?.agents:l?.agents.filter(n=>n.status===r),y=n=>{i(n)};return e.jsxs("div",{className:h("space-y-6 p-6",a),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agents"}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs",title:g?"Real-time updates active":"Connecting...",children:[e.jsx("span",{className:`inline-block h-2 w-2 rounded-full ${g?"bg-green-400":"bg-yellow-400 animate-pulse"}`}),e.jsx("span",{className:"text-gray-500",children:g?"Live":"Connecting"})]})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage and monitor your registered agents."})]}),t?e.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Register Agent"]}):null]}),e.jsx(q,{counts:l?.counts,isLoading:c,onStatClick:y}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Filter agents",children:H.map(n=>e.jsxs("button",{onClick:()=>i(n.id),className:h("whitespace-nowrap border-b-2 px-1 py-4 text-sm font-medium transition-colors",r===n.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),"aria-current":r===n.id?"page":void 0,children:[n.label,n.id!=="all"&&l?.counts?e.jsx("span",{className:h("ml-2 rounded-full px-2 py-0.5 text-xs",r===n.id?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:l.counts[n.id]}):null]},n.id))})}),o?e.jsx(K,{message:o instanceof Error?o.message:"Unknown error",onRetry:()=>{j()}}):c?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3,4,5,6].map(n=>e.jsx(D,{},n))}):m&&m.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:m.map(n=>e.jsx($,{agent:n,onClick:s?()=>s(n.id):void 0},n.id))}):e.jsx(Q,{filter:r})]})}export{Y as default};
